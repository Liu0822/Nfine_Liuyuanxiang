@{
    ViewBag.Title = "邮箱";
    Layout = "~/Views/Shared/_Form.cshtml";
}
<script>
    var editor;
    var k = $.request("k");
    $(function () {
        //判断从菜单进来就隐藏退回按钮，首页进现实按钮
        if (k == "") {
             $("#mail").find("#header").css("display", "none");
        }


        //Kind编辑器
        KindEditor.ready(function (K) {
            var options = {
                uploadJson: '/scripts/kindeditor/asp.net/upload_json.ashx',
                fileManagerJson: '/scripts/kindeditor/asp.net/file_manager_json.ashx',
                allowFileManager: true
            };
            window.editor = K.create('#content', options);
        });
    });
    //发送邮件
    function submitForm() {
        if (!$('#form1').formValid()) {
            return false;
        }
        var postData = $("#form1").formSerialize();
        console.log(postData);
        postData["content"] = editor.html();   //Kindeditor获取
        $.submitForm({
            loading: "正在发送邮件...",
            url: "/ExampleManage/SendMail/SendMail",
            param: postData,
            success: function () {
                $.reload();
            }
        })
    }

</script>
<form id="form1">
    <div class="mail-box">
        <div class="mail-header">邮件</div>
        <div class="mail-body">
            <table class="form">
                <tr>
                    <th class="formTitle"></th>
                    <td class="formValue">
                        <input id="account" name="account" type="text" class="form-control required" placeholder="QQ + &#64;" style="width:600px; margin:0 auto"  oninput="if(/&#64;$/.test(value) && this.tvl<value.length) value+='qq.com'; this.tvl=value.length;"/>                  
                    </td>             
                </tr>   
                <tr>
                    <th class="formTitle"></th>
                    <td class="formValue">
                        <input id="title" name="title" type="text" class="form-control"  style="width:600px; margin:0 auto" placeholder="输入标题"/>
                    </td>
                </tr>
            </table>
        </div>
        <div class="mail-body"style="width:1000px; margin:0 auto;">
            <textarea id="content" name="content" class="form-control"  style="height:500px;" rows="5"></textarea>
        </div>
        <div class="mail-body" style="text-align: center;" id="mail">
            <a href="javascript:void()" onclick="submitForm()" class="btn btn-primary"><i class="fa fa-paper-plane"></i>&nbsp; 发送</a>
            <a href="javascript:history.go(-1)" onclick="submitForm1()" class="btn btn-primary" id="header"  title="此操作与浏览器左上角退后功能一致"><b><i class="fa fa-mail-reply-all"></i>&nbsp; 退回至上一步</b></a>
        </div>
    </div>
</form>
